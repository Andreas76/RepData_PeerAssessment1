---
title: "Reproducible data assignment 1"
author: "Andreas Johansson"
date: "6/9/2016"
output: html_document
---

Unzip and read the data file:

```{r, echo=TRUE}
# Unpack file -------------------------------------------------------------
unzip("activity.zip")
# filename = unzip(zipfile = "activity.zip", list=TRUE)$Name[1]
data <- read.csv("activity.csv", sep = ",", header = TRUE, stringsAsFactors = FALSE)
# Change to NA for missing data -------------------------------------------
data[data == 0] = NA
# data = data[data$steps != 0,]
```

Set the date format to posix:

```{r, echo=TRUE}
posixdate <- as.POSIXct(paste(data$date), format="%Y-%m-%d")
data$date <- NULL
data <- cbind(data, posixdate)
names(data)[3] <- "Date"
```

```{r, echo=TRUE}
# Calculate stats for plotting --------------------------------------------
library(plyr)

Date_stats <- ddply(data, c("Date"), summarise,
               Total    = sum(steps, na.rm = TRUE),
               Mean = mean(steps, na.rm = TRUE))
```

Histogram of number of steps per day:

```{r, echo=TRUE}
hist(Date_stats$Total, xlab = "Average number of daily steps", ylab="Number of days", main="")
```

Calculate the mean and median number of daily steps:

```{r, echo=TRUE}
Mean_steps = round(mean(Date_stats$Total, na.rm = TRUE))
Median_steps = median(Date_stats$Total, na.rm = TRUE)

```
The mean: `r Mean_steps` and median: `r Median_steps` number of daily steps

```{r, echo=TRUE}
# Calculate stats for plotting --------------------------------------------
Interval_stats <- ddply(data, c("interval"), summarise,
               Total    = sum(steps, na.rm = TRUE),
               Mean    = mean(steps, na.rm = TRUE))
```

The average number of steps per 5-min time interval:

```{r}
plot(Interval_stats$interval, Interval_stats$Mean,  type="l", ylab = "Average number of steps", xlab = "5-min time interval")
```

Find the 5-min time-interval with the largest number of steps on average:
```{r}
Max_steps <- max(Interval_stats$Mean, na.rm = TRUE)
Max_interval <- which.max(Interval_stats$Mean)
```

The 5-min interval with the on average largest number of steps is: `r Max_interval`

Replace missing values with the average for the 5-min period:

```{r}
range_interval <- seq(0, 2355, by=5)
range_df <- data.frame(range_interval)
data2 <- merge(data, range_df)
```

